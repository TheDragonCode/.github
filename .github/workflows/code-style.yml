name: Code Style

on:
    workflow_call:
        inputs:
            token:
                required: true
                type: string
            fix:
                required: false
                type: boolean
                default: false
            editorconfig:
                required: false
                type: boolean
                default: true
            dependabot:
                required: false
                type: boolean
                default: true
            normalize:
                required: false
                type: boolean
                default: true

jobs:
    style:
        runs-on: ubuntu-latest

        steps:
            -   name: Checkout code
                uses: actions/checkout@v3

            -   name: Detect job name
                id: detect
                run: |
                    [[ ${{ inputs.fix }} ]] && NAME="Fix" || NAME="Check"
                    
                    echo "name=${NAME}" >> $GITHUB_OUTPUT

            -   name: ${{ steps.detect.outputs.name }} the code style
                uses: TheDragonCode/codestyler@v3
                with:
                    github_token: ${{ inputs.token }}
                    fix: ${{ inputs.fix }}
                    editorconfig: ${{ inputs.editorconfig }}
                    dependabot: ${{ inputs.dependabot }}
                    normalize: ${{ inputs.normalize }}
